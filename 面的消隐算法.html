<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hidden Surface Removal</title>
    <style>
        canvas {
            display: block;
            margin: 0 auto;
            background-color: #fff;
        }
    </style>
</head>
<body>
    <canvas id="canvas" width="800" height="600"></canvas>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        const cubeVertices = [
            { x: -1, y: -1, z: -1 },
            { x:  1, y: -1, z: -1 },
            { x:  1, y:  1, z: -1 },
            { x: -1, y:  1, z: -1 },
            { x: -1, y: -1, z:  1 },
            { x:  1, y: -1, z:  1 },
            { x:  1, y:  1, z:  1 },
            { x: -1, y:  1, z:  1 }
        ];

        const cubeFaces = [
            [0, 1, 2, 3],
            [4, 5, 6, 7],
            [0, 1, 5, 4],
            [1, 2, 6, 5],
            [2, 3, 7, 6],
            [3, 0, 4, 7]
        ];

        const camera = { x: 0, y: 0, z: -5 };
        const light = { x: 5, y: 5, z: -10 };

        function project(vertex) {
            const scale = 300 / (camera.z - vertex.z);
            return {
                x: vertex.x * scale + canvas.width / 2,
                y: vertex.y * scale + canvas.height / 2,
                z: vertex.z
            };
        }

        function rotateX(vertex, angle) {
            const cos = Math.cos(angle);
            const sin = Math.sin(angle);
            return {
                x: vertex.x,
                y: vertex.y * cos - vertex.z * sin,
                z: vertex.y * sin + vertex.z * cos
            };
        }

        function rotateY(vertex, angle) {
            const cos = Math.cos(angle);
            const sin = Math.sin(angle);
            return {
                x: vertex.x * cos + vertex.z * sin,
                y: vertex.y,
                z: -vertex.x * sin + vertex.z * cos
            };
        }

        function rotateZ(vertex, angle) {
            const cos = Math.cos(angle);
            const sin = Math.sin(angle);
            return {
                x: vertex.x * cos - vertex.y * sin,
                y: vertex.x * sin + vertex.y * cos,
                z: vertex.z
            };
        }

        function drawFace(face) {
            ctx.beginPath();
            for (let i = 0; i < face.length; i++) {
                const vertex = project(face[i]);
                if (i === 0) {
                    ctx.moveTo(vertex.x, vertex.y);
                } else {
                    ctx.lineTo(vertex.x, vertex.y);
                }
            }
            ctx.closePath();
            ctx.stroke();
        }

        function render() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            const angle = Date.now() * 0.001;
            const rotatedVertices = cubeVertices.map(v => rotateX(rotateY(rotateZ(v, angle), angle), angle));

            const faces = cubeFaces.map(face => face.map(i => rotatedVertices[i]));
            faces.sort((a, b) => {
                const za = a.reduce((sum, v) => sum + v.z, 0) / a.length;
                const zb = b.reduce((sum, v) => sum + v.z, 0) / b.length;
                return zb - za;
            });

            faces.forEach(face => drawFace(face));

            requestAnimationFrame(render);
        }

        render();
    </script>
</body>
</html>
